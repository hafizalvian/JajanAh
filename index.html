<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JajanAh - Pesan Makanan & Minuman</title>
    <link rel="stylesheet" href="asset/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="mobile-container">
        <!-- Header -->
        <header>
            <div class="location-bar">
                <div class="location-selector">
                    <i class="fas fa-map-marker-alt"></i>
                    <select id="location">
                        <option value="cibingbin">Cibingbin</option>
                        <option value="sukamaju">Sukamaju</option>
                        <option value="sukaharja">Sukaharja</option>
                        <option value="sindangjawa">Sindangjawa</option>
                        <option value="citenjo">Citenjo</option>
                    </select>
                </div>
                <div class="settings-icon" onclick="toggleSettings()">
                    <i class="fas fa-cog"></i>
                </div>
            </div>
            <div class="logo">
                <h1>JajanAh</h1>
                <p style="color: #fff;">Platform jajan lewat online</p>
            </div>
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Cari makanan atau toko..." id="searchInput">
                <button class="search-btn" onclick="searchFood()">Cari</button>
            </div>
        </header>

        <!-- Settings Menu (Hidden by default) -->
        <div id="settings-menu" class="settings-menu">
            <div class="settings-header">
                <h3>Pengaturan</h3>
                <i class="fas fa-times" onclick="toggleSettings()"></i>
            </div>
            <div class="settings-options">
                <div class="settings-option" onclick="openProfile()">
                    <i class="fas fa-user-circle"></i>
                    <p>Profil</p>
                </div>
                <div class="settings-option" onclick="openAccount()">
                    <i class="fas fa-user-cog"></i>
                    <p>Akun</p>
                </div>
                <div class="settings-option" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <p>Logout</p>
                </div>
            </div>
        </div>

        <!-- Promo Banner -->
        <div class="promo-banner">
            <img src="asset/img/banner.png" alt="Promo JajanAh">
        </div>

        <!-- Kategori -->
        <div class="categories">
            <h2>Kategori</h2>
            <div class="category-list">
                <div class="category-item">
                    <div class="category-icon">
                        <i class="fas fa-coffee"></i>
                    </div>
                    <p>Minuman</p>
                </div>
                <div class="category-item">
                    <div class="category-icon">
                        <i class="fa fa-cutlery" aria-hidden="true"></i>
                    </div>
                    <p>Makanan Berat</p>
                </div>
                <div class="category-item">
                    <div class="category-icon">
                        <i class="fa-solid fa-cookie-bite"></i>
                    </div>
                    <p>Cemilan</p>
                </div>
                <div class="category-item">
                    <div class="category-icon">
                        <i class="fa-solid fa-cake-candles"></i>
                    </div>
                    <p>Kue & Roti</p>
                </div>
            </div>
        </div>

        <!-- Toko Populer -->
        <div class="popular-stores">
            <h2>Toko Populer</h2>
            <div class="store-list">
                <div class="store-card" onclick="openStoreDetail('esteh')">
                    <div class="store-image">
                        <img src="asset/img/esteh.jpg" alt="Es Teh">
                    </div>
                    <div class="store-info">
                        <h3>Esteh Solo</h3>
                        <div class="store-rating">
                            <i class="fas fa-star"></i>
                            <span>4.8</span>
                            <span class="store-distance">0.5 km</span>
                        </div>
                        <p>Minuman, Teh</p>
                    </div>
                </div>
                <div class="store-card" onclick="openStoreDetail('chicken')">
                    <div class="store-image">
                        <img src="asset/img/ayam.png" alt="Chicken Crisbar">
                    </div>
                    <div class="store-info">
                        <h3>RB Chicken Crisbar</h3>
                        <div class="store-rating">
                            <i class="fas fa-star"></i>
                            <span>4.6</span>
                            <span class="store-distance">0.8 km</span>
                        </div>
                        <p>Ayam, Crispy</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Jajanan Populer -->
        <div class="popular-food">
            <h2>Jajanan Populer</h2>
            <div class="food-list">
                <div class="food-card">
                    <div class="food-image">
                        <img src="asset/img/seblak.png" alt="Seblak">
                    </div>
                    <div class="food-info">
                        <h3>Seblak Teh Ade</h3>
                        <p>Rp 15.000</p>
                    </div>
                </div>
                <div class="food-card">
                    <div class="food-image">
                        <img src="asset/img/bakso.jpg" alt="Batagor">
                    </div>
                    <div class="food-info">
                        <h3>Bako</h3>
                        <p>Rp 12.000</p>
                    </div>
                </div>
                <div class="food-card">
                    <div class="food-image">
                        <img src="asset/img/nasi goreng.png" alt="Cilok">
                    </div>
                    <div class="food-info">
                        <h3>Nasi Goreng</h3>
                        <p>Rp 10.000</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detail Toko (Hidden by default) -->
        <div id="store-detail" class="store-detail">
            <div class="store-detail-header">
                <i class="fas fa-arrow-left" onclick="closeStoreDetail()"></i>
                <h2 id="store-detail-name">Nama Toko</h2>
            </div>
            <div class="store-detail-banner">
                <img id="store-detail-image" src="" alt="Banner Toko">
            </div>
            <div class="store-detail-info">
                <div class="store-detail-rating">
                    <i class="fas fa-star"></i>
                    <span id="store-detail-rating">4.8</span>
                    <span class="divider">|</span>
                    <span id="store-detail-orders">1.2rb+ pesanan</span>
                </div>
                <div class="store-detail-distance">
                    <i class="fas fa-map-marker-alt"></i>
                    <span id="store-detail-distance">0.5 km</span>
                </div>
            </div>

            <div class="store-menu">
                <h3>Menu</h3>
                <div id="menu-list" class="menu-list">
                    <!-- Menu items will be populated dynamically -->
                </div>
            </div>
        </div>

        <!-- Cart (Hidden by default) -->
        <div id="cart" class="cart">
            <div class="cart-header">
                <h3>Keranjang</h3>
                <i class="fas fa-times" onclick="closeCart()"></i>
            </div>
            <div id="cart-items" class="cart-items">
                <!-- Cart items will be populated dynamically -->
            </div>
            <div class="cart-total">
                <p>Total:</p>
                <p id="cart-total-price">Rp 0</p>
            </div>
            <a href="https://wa.me/6283157142163" target="_blank" rel="noopener noreferrer" style="text-decoration: none;">
                <button class="checkout-btn">Pesan Sekarang</button>
            </a>            
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <div class="nav-item">
                <i class="fa-solid fa-house"></i>
                <p>Beranda</p>
            </div>
            <div class="nav-item">
                <i class="fas fa-search"></i>
                <p>Cari</p>
            </div>
            <div class="nav-item" onclick="openCart()">
                <i class="fas fa-shopping-cart"></i>
                <p>Keranjang</p>
                <span id="cart-badge" class="badge" style="display: none;">0</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-user"></i>
                <p>Profil</p>
            </div>
        </nav>
    </div>

    <script>
        // Data toko
        const stores = {
            esteh: {
                name: "Esteh Indonesia",
                image: "asset/img/banneresteh.jpg",
                rating: "4.8",
                orders: "1.2rb+",
                distance: "0.5 km",
                menu: [
                    { name: "Es Teh Original", price: 8000, image: "asset/img/esteh2.png"},
                    { name: "Es Teh Susu", price: 12000, image: "asset/img/esteh2.png" },
                    { name: "Es Teh Lemon", price: 10000, image: "asset/img/esteh2.png" },
                    { name: "Es Jeruk", price: 10000, image: "asset/img/esteh2.png" }
                ]
            },
            chicken: {
                name: "Chicken Crisbar",
                image: "asset/img/ayam.png",
                rating: "4.6",
                orders: "950+",
                distance: "0.8 km",
                menu: [
                    { name: "Ayam Crispy (1 pcs)", price: 15000, image: "asset/img/crisbar.png" },
                    { name: "Ayam Spicy (1 pcs)", price: 16000, image: "asset/img/crisbar.png" },
                    { name: "Chicken Strips", price: 20000, image: "asset/img/crisbar.png" },
                    { name: "Paket Nasi + Ayam", price: 25000, image: "asset/img/crisbar.png" }
                ]
            }
        };

        // Keranjang belanja
        let cartItems = [];
        let cartTotal = 0;

        // Fungsi untuk membuka detail toko
        function openStoreDetail(storeId) {
            const store = stores[storeId];
            document.getElementById('store-detail-name').textContent = store.name;
            document.getElementById('store-detail-image').src = store.image;
            document.getElementById('store-detail-rating').textContent = store.rating;
            document.getElementById('store-detail-orders').textContent = store.orders + " pesanan";
            document.getElementById('store-detail-distance').textContent = store.distance;

            // Populate menu
            const menuList = document.getElementById('menu-list');
            menuList.innerHTML = '';
            
            store.menu.forEach(item => {
                const menuItem = document.createElement('div');
                menuItem.className = 'menu-item';
                menuItem.innerHTML = `
                    <div class="menu-item-image">
                        <img src="${item.image}" alt="${item.name}">
                    </div>
                    <div class="menu-item-info">
                        <h4>${item.name}</h4>
                        <p>Rp ${item.price.toLocaleString()}</p>
                    </div>
                    <button class="add-to-cart-btn" onclick="addToCart('${storeId}', '${item.name}', ${item.price})">+</button>
                `;
                menuList.appendChild(menuItem);
            });

            document.getElementById('store-detail').style.display = 'block';
            document.querySelector('.mobile-container').style.overflow = 'hidden';
        }

        // Fungsi untuk menutup detail toko
        function closeStoreDetail() {
            document.getElementById('store-detail').style.display = 'none';
            document.querySelector('.mobile-container').style.overflow = 'auto';
        }

        // Fungsi untuk menambahkan item ke keranjang
        function addToCart(storeId, itemName, price) {
            const existingItem = cartItems.find(item => item.name === itemName);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cartItems.push({
                    storeId: storeId,
                    name: itemName,
                    price: price,
                    quantity: 1
                });
            }
            
            updateCart();
            openCart(); // Langsung membuka keranjang saat item ditambahkan
            showToast(`${itemName} ditambahkan ke keranjang!`);
        }

        // Fungsi untuk memperbarui tampilan keranjang
        function updateCart() {
            const cartItemsContainer = document.getElementById('cart-items');
            cartItemsContainer.innerHTML = '';
            
            cartTotal = 0;
            let totalItems = 0;
            
            cartItems.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                cartTotal += itemTotal;
                totalItems += item.quantity;
                
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-info">
                        <h4>${item.name}</h4>
                        <p>Rp ${item.price.toLocaleString()} x ${item.quantity}</p>
                    </div>
                    <div class="cart-item-actions">
                        <button onclick="decreaseQuantity(${index})">-</button>
                        <span>${item.quantity}</span>
                        <button onclick="increaseQuantity(${index})">+</button>
                    </div>
                    <div class="cart-item-total">
                        <p>Rp ${itemTotal.toLocaleString()}</p>
                    </div>
                `;
                cartItemsContainer.appendChild(cartItem);
            });
            
            document.getElementById('cart-total-price').textContent = `Rp ${cartTotal.toLocaleString()}`;
            
            // Update badge
            const cartBadge = document.getElementById('cart-badge');
            if (totalItems > 0) {
                cartBadge.textContent = totalItems;
                cartBadge.style.display = 'flex';
            } else {
                cartBadge.style.display = 'none';
            }
        }

        // Fungsi untuk membuka keranjang
        function openCart() {
            document.getElementById('cart').style.display = 'block';
            document.getElementById('cart').classList.add('cart-open');
        }

        // Fungsi untuk menutup keranjang
        function closeCart() {
            document.getElementById('cart').classList.remove('cart-open');
            setTimeout(() => {
                document.getElementById('cart').style.display = 'none';
            }, 300);
        }

        // Fungsi untuk menambah jumlah item di keranjang
        function increaseQuantity(index) {
            cartItems[index].quantity += 1;
            updateCart();
        }

        // Fungsi untuk mengurangi jumlah item di keranjang
        function decreaseQuantity(index) {
            if (cartItems[index].quantity > 1) {
                cartItems[index].quantity -= 1;
            } else {
                cartItems.splice(index, 1);
            }
            updateCart();
        }
        
        // Fungsi untuk toggle menu pengaturan
        function toggleSettings() {
            const settingsMenu = document.getElementById('settings-menu');
            if (settingsMenu.classList.contains('show')) {
                settingsMenu.classList.remove('show');
            } else {
                settingsMenu.classList.add('show');
            }
        }
        
        // Fungsi untuk menampilkan toast notification
        function showToast(message) {
            // Cek apakah sudah ada toast
            let toast = document.querySelector('.toast');
            if (!toast) {
                toast = document.createElement('div');
                toast.className = 'toast';
                document.body.appendChild(toast);
            }
            
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Fungsi pencarian
        function searchFood() {
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            if (searchInput.trim() === '') {
                showToast('Masukkan kata kunci pencarian');
                return;
            }
            
            let found = false;
            
            // Cari di menu toko
            for (const storeId in stores) {
                const store = stores[storeId];
                const menuItems = store.menu.filter(item => 
                    item.name.toLowerCase().includes(searchInput)
                );
                
                if (menuItems.length > 0) {
                    found = true;
                    openStoreDetail(storeId);
                    showToast(`Ditemukan di ${store.name}`);
                    
                    // Highlight item yang ditemukan
                    setTimeout(() => {
                        const menuElements = document.querySelectorAll('.menu-item h4');
                        menuElements.forEach(el => {
                            if (el.textContent.toLowerCase().includes(searchInput)) {
                                el.parentElement.parentElement.classList.add('highlight');
                            }
                        });
                    }, 300);
                    
                    break;
                }
            }
            
            // Cari nama toko
            if (!found) {
                for (const storeId in stores) {
                    const store = stores[storeId];
                    if (store.name.toLowerCase().includes(searchInput)) {
                        found = true;
                        openStoreDetail(storeId);
                        showToast(`Toko ditemukan`);
                        break;
                    }
                }
            }
            
            if (!found) {
                showToast('Tidak ditemukan hasil pencarian');
            }
        }
        
        // Fungsi untuk profil
        function openProfile() {
            showToast('Membuka halaman profil');
            toggleSettings();
        }
        
        // Fungsi untuk akun
        function openAccount() {
            showToast('Membuka pengaturan akun');
            toggleSettings();
        }
        
        // Fungsi untuk logout
        function logout() {
            showToast('Anda telah logout');
            toggleSettings();
        }
        
        // Event listener untuk dropdown lokasi
        document.getElementById('location').addEventListener('change', function() {
            const selectedLocation = this.value;
            showToast(`Lokasi diubah ke: ${this.options[this.selectedIndex].text}`);
        });
        
        // Event listener untuk pencarian dengan tombol Enter
        document.getElementById('searchInput').addEventListener('keyup', function(event) {
            if (event.key === 'Enter') {
                searchFood();
            }
        });
        
        // Inisialisasi touch events untuk keranjang
        let startY, moveY;
        const cart = document.getElementById('cart');
        
        cart.addEventListener('touchstart', function(e) {
            startY = e.touches[0].clientY;
        });
        
        cart.addEventListener('touchmove', function(e) {
            moveY = e.touches[0].clientY;
            const diff = moveY - startY;
            
            // Jika digeser ke bawah
            if (diff > 0) {
                e.preventDefault();
                cart.style.transform = `translateY(${diff}px)`;
            }
        });
        
        cart.addEventListener('touchend', function() {
            const diff = moveY - startY;
            
            // Jika digeser cukup jauh ke bawah, tutup keranjang
            if (diff > 100) {
                closeCart();
            } else {
                // Kembalikan ke posisi semula
                cart.style.transform = 'translateY(0)';
            }
        });
    </script>
</body>
</html>
